ðŸ“• **TÃ­tulo: CineCampus**

------

**Tiempo de ejecuciÃ³n**: 4 Dias

**Nivel de dificultad:** â˜…â˜…â˜…â˜…â˜†

### **Problematica**

CineCampus es una empresa de entretenimiento que se especializa en ofrecer una experiencia de cine completa y personalizada. La empresa desea desarrollar una aplicaciÃ³n web que permita a los usuarios seleccionar pelÃ­culas, comprar boletos y asignar asientos de manera eficiente y cÃ³moda. La aplicaciÃ³n tambiÃ©n ofrecerÃ¡ opciones de descuento para usuarios con tarjeta VIP y permitirÃ¡ realizar compras en lÃ­nea.

### **Objetivo**

Desarrollar una serie de APIs para la aplicaciÃ³n web de CineCampus utilizando MongoDB como base de datos. Las APIs deberÃ¡n gestionar la selecciÃ³n de pelÃ­culas, la compra de boletos, la asignaciÃ³n de asientos, y la implementaciÃ³n de descuentos para tarjetas VIP, con soporte para diferentes roles de usuario.

### Requisitos Funcionales

1. SelecciÃ³n de PelÃ­culas:

   - **API para Listar PelÃ­culas:** Permitir la consulta de todas las pelÃ­culas disponibles en el catÃ¡logo, con detalles como tÃ­tulo, gÃ©nero, duraciÃ³n y horarios de proyecciÃ³n.

     ```javascript
     //Aunque el estado que se desea consultar es "En cartelera", no dude en realizar consultas adicionales segÃºn sea necesario, usando "PrÃ³ximamente" o "Retirada de Cartelera"//
     
      let obj = new Pelicula()
      const status = "En cartelera"; 
      const moviesAndFunctions = await obj.getAllMoviesAndFunctionsInfo(status);
      console.table(moviesAndFunctions);


       //common.js 
       
        Pelicula.getInstance()
        .then(peliculaInstance => {
            // Verifica si la instancia es vÃ¡lida
            if (!peliculaInstance) {
                throw new Error('Pelicula instance is not available');
            }

            // Llama al mÃ©todo con el estado deseado
            return peliculaInstance.getAllMoviesAndFunctionsInfo('En cartelera');
        })
        .then(moviesAndFunctions => {
            console.log('Movies and Functions Info:', moviesAndFunctions);
        })
        .catch(error => {
            console.error('Error initializing Pelicula:', error);
        });
     ```

     

   - **API para Obtener Detalles de PelÃ­cula:** Permitir la consulta de informaciÃ³n detallada sobre una pelÃ­cula especÃ­fica, incluyendo sinopsis.

   ```javascript
   //Otros titulos son: "La Noche de los Monstruos","El Viaje IntergalÃ¡ctico"//
   
   let obj = new Pelicula()
   const titulo = "El Gran Escape"; 
   const specificMovie = await obj.getAnEspecificMovieInfo(titulo);
   console.table(specificMovie);

   //common.js
   Pelicula.getInstance()
    .then(peliculaInstance => {
        const titulo = "El Gran Escape"; 
        return peliculaInstance.getAnEspecificMovieInfo(titulo);
    })
    .then(specificMovie => {
        console.table(specificMovie);
        Pelicula.closeConnection(); // AsegÃºrate de cerrar la conexiÃ³n
    })
    .catch(error => {
        console.error('Error initializing Pelicula:', error);
        Pelicula.closeConnection(); // AsegÃºrate de cerrar la conexiÃ³n en caso de error
    });

   ```

   

2. - Compra de Boletos:

     - **API para Comprar Boletos:** Permitir la compra de boletos para una pelÃ­cula especÃ­fica, incluyendo la selecciÃ³n de la fecha y la hora de la proyecciÃ³n.

     - **API para Verificar Disponibilidad de Asientos:** Permitir la consulta de la disponibilidad de asientos en una sala para una proyecciÃ³n especÃ­fica.

       ```javascript
       //FiltrarÃ¡ los asientos con el estado "Por Asignar". Inserte el ObjectId de la funciÃ³n, por ejemplo: "64a7e409f7a42a24c8d7e825", "64a7e409f7a42a24c8d7e826" o "64a7e409f7a42a24c8d7e82e".//
       
       let obj = new Asiento() 
       const asientoInstance = new Asiento();
       const idFuncion = "64a7e409f7a42a24c8d7e826";
       asientoInstance.getAllSeatsByFunction(idFuncion).then(seats => {
           console.log("Available seats:", seats);
       }).catch(err => {
           console.error("Error:", err);
       });


       //common js

       let obj = new Asiento();
        const asientoInstance = new Asiento();

        const idFuncion = "64a7e409f7a42a24c8d7e826";


        asientoInstance.getAllSeatsByFunction(idFuncion)
            .then(seats => {
                console.log("Available seats:", seats);
            })
            .catch(err => {
                console.error("Error:", err);
            })
            .finally(() => {

                Asiento.closeConnection();
            });
    

3. AsignaciÃ³n de Asientos:

   - **API para Reservar Asientos:** Permitir la selecciÃ³n y reserva de asientos para una proyecciÃ³n especÃ­fica.

   ```javascript
     //Inserte un "seatId" de un asiento al cual quiera asignar el estado "Reservado". Puede probar con alguno de estos asientos: "64a7e409f7a42a24c8d7e82f" o "64a7e409f7a42a24c8d7e830". Adicionalmente, podrÃ¡ asignar el asiento a una proyecciÃ³n/funciÃ³n especÃ­fica. Como ejemplo, considere los siguientes "functionId": "64a7e409f7a42a24c8d7e860" o "64a7e409f7a42a24c8d7e863".//
     
     let obj = new Asiento() 
     const asientoInstance = new Asiento();
     const seatId = "64a7e409f7a42a24c8d7e82b"; 
     const functionId = "64a7e409f7a42a24c8d7e828"; 
     
     asientoInstance.setAReservetoASeatForAFunction(seatId, functionId).then(result => {
         console.log(result.message);
     }).catch(err => {
         console.error("Error:", err);
     });
     
     
     //common js

     const asientoInstance = new Asiento();

    const seatId = "64a7e409f7a42a24c8d7e82b"; 
    const functionId = "64a7e409f7a42a24c8d7e828"; 

    asientoInstance.setAReservetoASeatForAFunction(seatId, functionId)
        .then(result => {
            console.log(result.message); 
        })
        .catch(err => {
            console.error("Error:", err); 
        })
        .finally(() => {
            Asiento.closeConnection();
        });

     ``javascript

     //PodrÃ¡ ver el horario, estado y sala de la reserva con los siguientes "_id": "64a7e409f7a42a24c8d7e850","64a7e409f7a42a24c8d7e82b"// AdemÃ¡s, podrÃ¡ identificar cuÃ¡ndo un asiento no ha sido reservado comprobando el siguiente "_id":"64a7e409f7a42a24c8d7e848"
     
     const asientoInstance = new Asiento();
     const seatId = "64a7e409f7a42a24c8d7e82b"; 
     
     asientoInstance.getAllTSeatsReservedByFunction(seatId).then(result => {
         if (result.success) {
             console.log("Seat details:", result.data);
         } else {
             console.log(result.message);
         }
     }).catch(err => {
         console.error("Error:", err);
     });

     //common js

     const asientoInstance = new Asiento();
    const seatId = "64a7e409f7a42a24c8d7e82b";

    asientoInstance.getAllTSeatsReservedByFunction(seatId)
        .then(result => {
            if (result.success) {
                console.log("Seat details:", result.data);
            } else {
                console.log(result.message);
            }
        })
        .catch(err => {
            console.error("Error:", err);
        });

     ```

     

   - **API para Cancelar Reserva de Asientos:** Permitir la cancelaciÃ³n de una reserva de asiento ya realizada.

   ```javascript
   // Este "Seatid" ya ha sido ejecutado, por tanto, la validaciÃ³n indica que el asiento no se puede cancelar por que ya no estÃ¡ reservado, para ver la cancelaciÃ³n, podrÃ¡ ejecutar los el siguiente "seatId": "64a7e409f7a42a24c8d7e879"
   
   const asientoInstance = new Asiento();
   const seatId = "64a7e409f7a42a24c8d7e879"; 
   
   asientoInstance.setACancelationtoAReservedSeat(seatId).then(result => {
       console.log(result.message);
   }).catch(err => {
       console.error("Error:", err);
   });
   ```

   

4. Descuentos y Tarjetas VIP:

   - **API para Aplicar Descuentos:** Permitir la aplicaciÃ³n de descuentos en la compra de boletos para usuarios con tarjeta VIP.
   - **API para Verificar Tarjeta VIP:** Permitir la verificaciÃ³n de la validez de una tarjeta VIP durante el proceso de compra.

5. Roles Definidos: **Administrador:** Tiene permisos completos para gestionar el sistema, incluyendo la venta de boletos en el lugar fÃ­sico. Los administradores no estÃ¡n involucrados en las compras en lÃ­nea realizadas por los usuarios. **Usuario EstÃ¡ndar:** Puede comprar boletos en lÃ­nea sin la intervenciÃ³n del administrador. **Usuario VIP:** Puede comprar boletos en lÃ­nea con descuentos aplicables para titulares de tarjetas VIP.

   

6. **API para Crear Usuario:** Permitir la creaciÃ³n de nuevos usuarios en el sistema, asignando roles y privilegios especÃ­ficos (usuario estÃ¡ndar, usuario VIP o administrador)

   ```javascript
   //Crear un usuario tipo "Administrador"
   
   let obj = new Cliente()
   console.log( await obj.createClientAndUser({ _id: new ObjectId(),nombre:"vincent",apellido:"Ruad",nick:"admnort",email:"exlpcampus@example.com","telefono":"3010284187",tipo_de_cliente:"",descuento:0,codigo_tarjeta:"",fecha_expedicion:null,estado: "", cedula: 1080091010, rol: "Administrador"}))

   //common js

   const clienteInstance = Cliente.getInstance();

    clienteInstance.createClientAndUser({
        _id: new ObjectId(),
        nombre: "vincent",
        apellido: "Ruad",
        nick: "admnort",
        email: "exlpcampus@example.com",
        telefono: "3010284187",
        tipo_de_cliente: "",
        descuento: 0,
        codigo_tarjeta: "",
        fecha_expedicion: null,
        estado: "",
        cedula: 1080091010,
        rol: "Administrador"
    })
    .then(result => {
        console.log(result);
    })
    .catch(error => {
        console.error("Error:", error);
    });
   
   //Crear un "usuarioVIP"
   
   let obj = new Cliente()
   console.log( await obj.createClientAndUser({ _id: new ObjectId(),nombre:"maxine",apellido:"jaddimes",nick:"docker",email:"preffcampus@example.com","telefono":"3150110087",tipo_de_cliente:"VIP",descuento:10,codigo_tarjeta:"VIP108410",fecha_expedicion:new Date("2024-07-15T00:00:00.000Z"),estado: "activo", cedula: 1097101010, rol: "usuarioVIP"}))
   
   //Crear "usuarioEstandar"
   
   let obj = new Cliente()
   console.log( await obj.createClientAndUser({ _id: new ObjectId(),nombre:"klimt",apellido:"dewy",nick:"fluxus",email:"devcampus@example.com","telefono":"3210233087",tipo_de_cliente:"Regular",descuento:0,codigo_tarjeta:"",fecha_expedicion:"",estado: "", cedula: 1039911717, rol: "usuarioEstandar"}))
   
   ```

7. **API para Obtener Detalles de Usuario:** Permitir la consulta de informaciÃ³n detallada sobre un usuario, incluyendo su rol y estado de tarjeta VIP

   ```javascript
   //podra utilizar otros "userId" si asÃ­ lo prefiere, como "66aa1145a69bc089a192f16c","66a966ce18a924c1093f439f"
   const cliente = new Cliente();
   const userId = "66aa0f35311f70d89314da1f";
   const userInfo = await cliente.getUserInfo(userId);
   console.log(userInfo);

   //common.js

   const cliente = new Cliente();
    const userId = "66aa0f35311f70d89314da1f";

    cliente.getUserInfo(userId)
        .then(userInfo => {
            console.log(userInfo);
        })
        .catch(error => {
            console.error('Error fetching user info:', error);
        });

   ```

8. *API para Listar Usuarios:** Permitir la consulta de todos los usuarios del sistema, con la posibilidad de filtrar por rol (VIP, estÃ¡ndar o administrador).

   ```javascript
   //Se podrÃ¡ consultar usuarios adicionales como 'usuarioVIP','Administrador',
   const clienteRol = new Cliente();
   console.log(await clienteRol.getUserByRoles('usuarioEstandar'));

   //common.js

    const clienteRol = new Cliente();
    const rol = 'usuarioEstandar';

    clienteRol.getUserByRoles(rol)
        .then(userByRoles => {
            console.log(userByRoles);
        })
        .catch(error => {
            console.error('Error fetching users by role:', error);
        });


   ```

9. Compras en LÃ­nea:

   - **API para Procesar Pagos:** Permitir el procesamiento de pagos en lÃ­nea para la compra de boletos.

   - **API para ConfirmaciÃ³n de Compra:** Enviar confirmaciÃ³n de la compra y los detalles del boleto al usuario.

     

### **Requisitos TÃ©cnicos**

- **Base de Datos:** Utilizar MongoDB para el almacenamiento de datos relacionados con pelÃ­culas, boletos, asientos, usuarios y roles.
- **AutenticaciÃ³n:** Implementar autenticaciÃ³n segura para el acceso a las APIs, utilizando roles de usuario para determinar los permisos y accesos (por ejemplo, usuarios VIP y usuarios estÃ¡ndar).
- **AutorizaciÃ³n de Roles:** Asegurar que las APIs y las operaciones disponibles estÃ©n adecuadamente restringidas segÃºn el rol del usuario (por ejemplo, aplicar descuentos solo a usuarios VIP).
- **DocumentaciÃ³n:** Proveer una documentaciÃ³n clara y completa para cada API, describiendo los endpoints, parÃ¡metros, y respuestas esperadas.
- **Recursos**

### **RÃºbrica Evaluativa**

Los puntos a evaluar serÃ¡n los siguientes:

### 1. SelecciÃ³n de PelÃ­culas (20%)

- **0 puntos:** No se implementa la funcionalidad para listar pelÃ­culas ni obtener detalles de una pelÃ­cula.
- **25 puntos:** La funcionalidad para listar pelÃ­culas o obtener detalles de una pelÃ­cula estÃ¡ parcialmente implementada, con errores significativos o faltante de caracterÃ­sticas importantes.
- **50 puntos:** La funcionalidad para listar pelÃ­culas y obtener detalles de una pelÃ­cula estÃ¡ implementada pero presenta errores menores o no proporciona todos los datos requeridos.
- **75 puntos:** La funcionalidad para listar pelÃ­culas y obtener detalles de una pelÃ­cula estÃ¡ mayormente correcta, pero con pequeÃ±os problemas de usabilidad o eficiencia.
- **100 puntos:** La funcionalidad para listar pelÃ­culas y obtener detalles de una pelÃ­cula estÃ¡ completamente implementada, es eficiente, y proporciona toda la informaciÃ³n requerida de manera clara.

### 2. Compra de Boletos (20%)

- **0 puntos:** No se implementa la funcionalidad para comprar boletos ni verificar la disponibilidad de asientos.
- **25 puntos:** La funcionalidad para comprar boletos o verificar la disponibilidad de asientos estÃ¡ parcialmente implementada, con errores significativos o faltante de caracterÃ­sticas importantes.
- **50 puntos:** La funcionalidad para comprar boletos y verificar la disponibilidad de asientos estÃ¡ implementada pero presenta errores menores o no maneja todos los casos posibles.
- **75 puntos:** La funcionalidad para comprar boletos y verificar la disponibilidad de asientos estÃ¡ mayormente correcta, pero con pequeÃ±os problemas de usabilidad o eficiencia.
- **100 puntos:** La funcionalidad para comprar boletos y verificar la disponibilidad de asientos estÃ¡ completamente implementada, es eficiente, y maneja todos los casos posibles de manera clara.

### 3. AsignaciÃ³n de Asientos (20%)

- **0 puntos:** No se implementa la funcionalidad para reservar ni cancelar reservas de asientos.
- **25 puntos:** La funcionalidad para reservar o cancelar reservas de asientos estÃ¡ parcialmente implementada, con errores significativos o faltante de caracterÃ­sticas importantes.
- **50 puntos:** La funcionalidad para reservar y cancelar reservas de asientos estÃ¡ implementada pero presenta errores menores o no maneja todos los casos posibles.
- **75 puntos:** La funcionalidad para reservar y cancelar reservas de asientos estÃ¡ mayormente correcta, pero con pequeÃ±os problemas de usabilidad o eficiencia.
- **100 puntos:** La funcionalidad para reservar y cancelar reservas de asientos estÃ¡ completamente implementada, es eficiente, y maneja todos los casos posibles de manera clara.

### 4. Descuentos y Tarjetas VIP (10%)

- **0 puntos:** No se implementa la funcionalidad para aplicar descuentos ni verificar la validez de tarjetas VIP.
- **25 puntos:** La funcionalidad para aplicar descuentos o verificar la validez de tarjetas VIP estÃ¡ parcialmente implementada, con errores significativos o faltante de caracterÃ­sticas importantes.
- **50 puntos:** La funcionalidad para aplicar descuentos y verificar la validez de tarjetas VIP estÃ¡ implementada pero presenta errores menores o no maneja todos los casos posibles.
- **75 puntos:** La funcionalidad para aplicar descuentos y verificar la validez de tarjetas VIP estÃ¡ mayormente correcta, pero con pequeÃ±os problemas de usabilidad o eficiencia.
- **100 puntos:** La funcionalidad para aplicar descuentos y verificar la validez de tarjetas VIP estÃ¡ completamente implementada, es eficiente, y maneja todos los casos posibles de manera clara.

### 5. GestiÃ³n de Usuarios y Roles (10%)

- **0 puntos:** No se implementa la funcionalidad para gestionar usuarios ni roles.
- **25 puntos:** La funcionalidad para gestionar usuarios o roles estÃ¡ parcialmente implementada, con errores significativos o faltante de caracterÃ­sticas importantes.
- **50 puntos:** La funcionalidad para gestionar usuarios y roles estÃ¡ implementada pero presenta errores menores o no maneja todos los casos posibles.
- **75 puntos:** La funcionalidad para gestionar usuarios y roles estÃ¡ mayormente correcta, pero con pequeÃ±os problemas de usabilidad o eficiencia.
- **100 puntos:** La funcionalidad para gestionar usuarios y roles estÃ¡ completamente implementada, es eficiente, y maneja todos los casos posibles de manera clara.

### 6. Compras en LÃ­nea (10%)

- **0 puntos:** No se implementa la funcionalidad para procesar pagos ni enviar confirmaciones de compra.
- **25 puntos:** La funcionalidad para procesar pagos o enviar confirmaciones de compra estÃ¡ parcialmente implementada, con errores significativos o faltante de caracterÃ­sticas importantes.
- **50 puntos:** La funcionalidad para procesar pagos y enviar confirmaciones de compra estÃ¡ implementada pero presenta errores menores o no maneja todos los casos posibles.
- **75 puntos:** La funcionalidad para procesar pagos y enviar confirmaciones de compra estÃ¡ mayormente correcta, pero con pequeÃ±os problemas de usabilidad o eficiencia.
- **100 puntos:** La funcionalidad para procesar pagos y enviar confirmaciones de compra estÃ¡ completamente implementada, es eficiente, y maneja todos los casos posibles de manera clara.

### 7. DocumentaciÃ³n y Entregables (10%)

- **0 puntos:** No se entrega la documentaciÃ³n requerida ni el cÃ³digo fuente en el repositorio de GitHub.
- **25 puntos:** La documentaciÃ³n o el cÃ³digo fuente estÃ¡n incompletos o presentan errores significativos.
- **50 puntos:** La documentaciÃ³n y el cÃ³digo fuente estÃ¡n mayormente completos, pero con algunos errores menores o faltantes.
- **75 puntos:** La documentaciÃ³n y el cÃ³digo fuente estÃ¡n correctos, con pequeÃ±os problemas de claridad o detalles menores faltantes.
- **100 puntos:** La documentaciÃ³n y el cÃ³digo fuente estÃ¡n completos, claros y bien organizados, proporcionando toda la informaciÃ³n necesaria de manera eficiente.

### GitHub y Entrega de Proyecto

- ðŸš¨ **CancelaciÃ³n o AnulaciÃ³n del Proyecto** : No se entregÃ³ ningÃºn repositorio, su visualizaciÃ³n estÃ¡ oculta (o no compartida con el Trainer) o hubo adulteraciÃ³n despuÃ©s de la fecha y hora establecida para su entrega, ***Evidencia de clonaciÃ³n o conocido como `fork` de algÃºn repositorio, distribuciÃ³n y/o copia de dicho trabajo por cualquier medio de comunicaciÃ³n (verbal, digital, entre otras), se asumirÃ¡ como cancelaciÃ³n del proyecto de manera definitiva.*** ðŸš¨
- **25 puntos**: Se creÃ³ el repositorio, pero en su rama principal no se encuentra el proyecto general ,al igual que algÃºn archivo en relaciÃ³n al proyecto.
- **100 puntos**: Se creÃ³ exitosamente el repositorio, donde en su rama principal se encuentra el proyecto general y sus archivos en relaciÃ³n a ello, con evidencia de la participaciÃ³n del equipo completo de manera periÃ³dica.



